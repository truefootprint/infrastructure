{
  "builders": [{
    "ami_name": "tracker-backend {{timestamp}}",
    "type": "amazon-ebs",
    "region": "eu-west-2",
    "source_ami": "ami-0d8e27447ec2c8410",
    "instance_type": "t2.micro",
    "ssh_username": "ec2-user",
    "ssh_agent_auth": true,
    "ssh_keypair_name": "chris@truefootprint.com",
    "security_group_filter": {
      "filters": { "group-name": "open-ssh-and-http" }
    }
  }],
  "provisioners": [{
    "type": "shell",
    "scripts": [
      "scripts/copy-public-key",

      "scripts/update-packages",
      "scripts/install-dependencies",
      "scripts/install-postgres",
      "scripts/install-rbenv",
      "scripts/install-ruby",

      "scripts/setup-postgres",

      "scripts/clone-app",
      "scripts/bundle-gems",
      "scripts/generate-secret",
      "scripts/create-database",
      "scripts/migrate-database",

      "scripts/setup-puma"
    ]
  }]
}
